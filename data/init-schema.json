{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "https://www.cbs.tu-darmstadt.de/secureepilink/schemas/init-schema.json",
  "definitions": {
    "authentication": {
      "type": "object",
      "properties": {
        "authType": {"enum": ["none","apiKey"]},
        "additionalProperties": {
          "sharedKey": {"type": "string"}
        }
      },
      "required": ["authType"]
    },
    "field": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "frequency": {
          "type": "number"
        },
        "errorRate": {
          "type": "number"
        },
        "comparator": {
          "type": "string",
          "enum": [
            "binary",
            "dice"
          ]
        },
        "fieldType": {
          "enum": [
            "integer",
            "number",
            "string",
            "bitmask"
          ]
        },
        "bitlength": {
          "type": "number"
        }
      },
      "required": ["name", "frequency", "errorRate", "comparator", "fieldType", "bitlength"],
      "additionalProperties": false
    }
  },
  "type": "object",
  "properties": {
    "localAuthentication": {"$ref": "#/definitions/authentication"},
    "dataService": {
      "type": "object",
      "properties": {
        "url": {"type": "string"}
      },
      "required": ["url"],
      "additionalProperties": false
    },
    "connectionProfile": {
      "type": "object",
      "properties": {
        "url": {"type": "string"},
        "authentication": {"$ref": "#/definitions/authentication"},
      "  idType": {"type": "string"}
      },
      "required": ["url", "authentication", "idType"],
      "additionalProperties": true
    },
    "linkageService": {
      "type": "object",
      "properties": {
      "authentication": { "$ref": "#/definitions/authentication"},
      "url": { "type": "string"}
      },
      "required": ["url", "authentication"],
      "additionalProperties": false
    },
    "algorithm": {
      "type": "object",
      "properties": {
        "algoType": {"enum": ["epilink"]},
        "threshold_match": {"type": "number"},
        "threshold_non_match": {"type": "number"},
        "exchangeGroups": {"type": "array"},
        "fields": {"type": "array",
          "items": {"$ref": "#/definitions/field"},
          "additionalItems": false}
      },
      "required": ["algoType", "threshold_match", "threshold_non_match", "exchangeGroups", "fields"],
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
